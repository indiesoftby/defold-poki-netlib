!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function t(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}var i={};function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t(i,"DefaultSignalingURL",function(){return E}),t(i,"DefaultRTCConfiguration",function(){return L}),t(i,"DefaultDataChannels",function(){return O}),t(i,"Network",function(){return S});let s="turn:turn.rtc.poki.com";class r{async fillCredentials(e){var t,i;let n=JSON.parse(JSON.stringify(e));if(void 0!==e.testproxyURL||!(null!==(i=null===(t=n.iceServers)||void 0===t?void 0:t.some(e=>e.urls===s||e.urls.includes(s)))&&void 0!==i&&i)||void 0===n.iceServers)return n;void 0===this.runningPromise&&(this.runningPromise=new Promise(e=>{if(null!=this.cachedCredentials&&this.cachedCredentialsExpireAt>performance.now()){e(this.cachedCredentials);return}this.signaling.request({type:"credentials"}).then(t=>{if("credentials"===t.type){var i;this.cachedCredentials=t,this.cachedCredentialsExpireAt=performance.now()+((null!==(i=t.lifetime)&&void 0!==i?i:0)-60)*1e3,e(t)}}).catch(()=>{e({type:"credentials"}),this.cachedCredentials={type:"credentials"},this.cachedCredentialsExpireAt=performance.now()+5e3}),setTimeout(()=>{e({type:"credentials"}),this.cachedCredentials={type:"credentials"},this.cachedCredentialsExpireAt=performance.now()+5e3},5e3)}));let r=await this.runningPromise;return this.runningPromise=void 0,void 0===r.url||n.iceServers.forEach(e=>{if(e.urls===s||e.urls.includes(s)){var t;e.urls=null!==(t=r.url)&&void 0!==t?t:"",e.username=r.username,e.credential=r.credential}}),n}constructor(e){n(this,"signaling",void 0),n(this,"cachedCredentials",void 0),n(this,"cachedCredentialsExpireAt",void 0),n(this,"runningPromise",void 0),this.signaling=e,this.cachedCredentialsExpireAt=0}}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},s=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),s.forEach(function(t){n(e,t,i[t])})}return e}var c={},a=Object.prototype.hasOwnProperty,l="~";function h(){}function d(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function g(e,t,i,n,s){if("function"!=typeof i)throw TypeError("The listener must be a function");var r=new d(i,n||e,s),o=l?l+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],r]:e._events[o].push(r):(e._events[o]=r,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new h:delete e._events[t]}function v(){this._events=new h,this._eventsCount=0}Object.create&&(h.prototype=Object.create(null),new h().__proto__||(l=!1)),v.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)a.call(e,t)&&i.push(l?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},v.prototype.listeners=function(e){var t=l?l+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,r=Array(s);n<s;n++)r[n]=i[n].fn;return r},v.prototype.listenerCount=function(e){var t=l?l+e:e,i=this._events[t];return i?i.fn?1:i.length:0},v.prototype.emit=function(e,t,i,n,s,r){var o=l?l+e:e;if(!this._events[o])return!1;var c,a,h=this._events[o],d=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),d){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,n),!0;case 5:return h.fn.call(h.context,t,i,n,s),!0;case 6:return h.fn.call(h.context,t,i,n,s,r),!0}for(a=1,c=Array(d-1);a<d;a++)c[a-1]=arguments[a];h.fn.apply(h.context,c)}else{var g,u=h.length;for(a=0;a<u;a++)switch(h[a].once&&this.removeListener(e,h[a].fn,void 0,!0),d){case 1:h[a].fn.call(h[a].context);break;case 2:h[a].fn.call(h[a].context,t);break;case 3:h[a].fn.call(h[a].context,t,i);break;case 4:h[a].fn.call(h[a].context,t,i,n);break;default:if(!c)for(g=1,c=Array(d-1);g<d;g++)c[g-1]=arguments[g];h[a].fn.apply(h[a].context,c)}}return!0},v.prototype.on=function(e,t,i){return g(this,e,t,i,!1)},v.prototype.once=function(e,t,i){return g(this,e,t,i,!0)},v.prototype.removeListener=function(e,t,i,n){var s=l?l+e:e;if(!this._events[s])return this;if(!t)return u(this,s),this;var r=this._events[s];if(r.fn)r.fn!==t||n&&!r.once||i&&r.context!==i||u(this,s);else{for(var o=0,c=[],a=r.length;o<a;o++)(r[o].fn!==t||n&&!r[o].once||i&&r[o].context!==i)&&c.push(r[o]);c.length?this._events[s]=1===c.length?c[0]:c:u(this,s)}return this},v.prototype.removeAllListeners=function(e){var t;return e?(t=l?l+e:e,this._events[t]&&u(this,t)):(this._events=new h,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=l,v.EventEmitter=v,c=v;class p extends c.EventEmitter{connect(){let e=new WebSocket(this.url),t=()=>{this.reconnectAttempt=0,this.reconnecting=!1,this.send({type:"hello",game:this.network.gameID,id:this.receivedID,secret:this.receivedSecret})},i=r=>{let o=new f("socket-error","unexpected websocket error",r);this.network._onSignalingError(o),e.readyState===WebSocket.CLOSED&&(this.reconnecting=!1,e.removeEventListener("open",t),e.removeEventListener("error",i),e.removeEventListener("message",n),e.removeEventListener("close",s),setTimeout(()=>{this.reconnect()},100))},n=e=>{this.handleSignalingMessage(e.data).catch(e=>{})},s=()=>{if(!this.network.closing){let e=new f("socket-error","signaling socket closed");this.network._onSignalingError(e)}e.removeEventListener("open",t),e.removeEventListener("error",i),e.removeEventListener("message",n),e.removeEventListener("close",s),setTimeout(()=>{this.reconnect()},100)};return e.addEventListener("open",t),e.addEventListener("error",i),e.addEventListener("message",n),e.addEventListener("close",s),e}reconnect(){if(!this.reconnecting&&!this.network.closing){if(this.close(),this.requests.forEach(e=>e.reject(new f("socket-error","signaling socket closed"))),this.requests.clear(),this.reconnectAttempt>42){this.network.emit("failed"),this.network._onSignalingError(new f("socket-error","giving up on reconnecting to signaling server"));return}this.event("signaling","attempt-reconnect"),this.reconnecting=!0,setTimeout(()=>{this.ws=this.connect()},100*Math.random()*this.reconnectAttempt),this.reconnectAttempt+=1}}close(){this.ws.close()}async request(e){return await new Promise((t,i)=>{this.ws.readyState!==WebSocket.OPEN&&i(new f("socket-error","signaling socket not open"));let n=Math.random().toString(36).slice(2);e.rid=n,this.network.log("requesting signaling packet:",e.type);let s=JSON.stringify(e);this.ws.send(s),this.requests.set(n,{resolve:t,reject:i})})}send(e){if(this.ws.readyState===WebSocket.OPEN){this.network.log("sending signaling packet:",e.type);let t=JSON.stringify(e);this.ws.send(t)}}async handleSignalingMessage(e){try{var t,i,n,s,r,o,c,a;let l=JSON.parse(e);if(this.network.log("signaling packet received:",l.type),void 0!==l.rid){let e=this.requests.get(l.rid);null!=e&&(this.requests.delete(l.rid),"error"===l.type?e.reject(new f("server-error",l.message,void 0,l.code)):e.resolve(l))}switch(l.type){case"error":{let e=new f("server-error",l.message,void 0,l.code);if(this.network._onSignalingError(e),"missing-recipient"===l.code&&(null===(t=l.error)||void 0===t?void 0:t.recipient)!==void 0){let e=null===(i=l.error)||void 0===i?void 0:i.recipient;this.connections.has(e)&&(this.network.log("cleaning up missing recipient",e),null===(n=this.connections.get(e))||void 0===n||n.close("missing-recipient"))}else"reconnect-failed"===l.code&&this.network.close("reconnect failed")}break;case"welcome":if(void 0!==this.receivedID){this.network.log("signaling reconnected"),this.network.emit("signalingreconnected");return}if(""===l.id)throw Error("missing id on received welcome packet");this.receivedID=l.id,this.receivedSecret=l.secret,this.network.emit("ready"),this.network._prefetchTURNCredentials();break;case"joined":{let e=l.lobbyInfo.code;if(""===e)throw Error("missing lobby on received connect packet");this.currentLobby=e,this.currentLeader=l.lobbyInfo.leader,this.currentTerm=l.lobbyInfo.term,this.network.emit("lobby",e,l.lobbyInfo),void 0!==this.currentLeader&&this.network.emit("leader",this.currentLeader)}break;case"leader":if(void 0===this.currentLobby)return;l.term>this.currentTerm&&(this.currentLeader=l.leader,this.currentTerm=l.term,this.network.emit("leader",l.leader));break;case"lobbyUpdated":if(void 0===this.currentLobby)return;this.currentLobbyInfo=l.lobbyInfo,this.network.emit("lobbyUpdated",l.lobbyInfo.code,l.lobbyInfo);break;case"connect":if(this.receivedID===l.id)return;for(let e of(await this.network._addPeer(l.id,l.polite),null!==(r=this.replayQueue.get(l.id))&&void 0!==r?r:[]))await (null===(s=this.connections.get(l.id))||void 0===s?void 0:s._onSignalingMessage(e));this.replayQueue.delete(l.id);break;case"disconnect":this.connections.has(l.id)&&(null===(o=this.connections.get(l.id))||void 0===o||o.close());break;case"candidate":case"description":if(this.connections.has(l.source))await (null===(c=this.connections.get(l.source))||void 0===c?void 0:c._onSignalingMessage(l));else{let e=null!==(a=this.replayQueue.get(l.source))&&void 0!==a?a:[];e.push(l),this.replayQueue.set(l.source,e)}break;case"credentials":this.emit("credentials",l)}}catch(t){let e=new f("unknown-error",t);this.network._onSignalingError(e)}}async event(e,t,i){return await new Promise(n=>{setTimeout(()=>{this.send({type:"event",game:this.network.gameID,lobby:this.currentLobby,peer:this.network.id,category:e,action:t,data:i}),n()},0)})}constructor(e,t,i){super(),n(this,"network",void 0),n(this,"url",void 0),n(this,"ws",void 0),n(this,"reconnectAttempt",void 0),n(this,"reconnecting",void 0),n(this,"receivedID",void 0),n(this,"receivedSecret",void 0),n(this,"currentLobby",void 0),n(this,"currentLobbyInfo",void 0),n(this,"currentLeader",void 0),n(this,"currentTerm",void 0),n(this,"connections",void 0),n(this,"replayQueue",void 0),n(this,"requests",void 0),this.network=e,this.reconnectAttempt=0,this.reconnecting=!1,this.currentTerm=0,this.requests=new Map,this.url=i,this.connections=t,this.replayQueue=new Map,this.ws=this.connect()}}class f{toString(){return`[${this.type}: ${this.message}]`}constructor(e,t,i,s){n(this,"type",void 0),n(this,"message",void 0),n(this,"event",void 0),n(this,"code",void 0),this.type=e,this.message=t,this.event=i,this.code=s}}let w="ping",y="pong";class m{ping(){var e,t;this.lastPingSentAt=performance.now(),(null===(e=this.control)||void 0===e?void 0:e.readyState)==="open"&&(null===(t=this.control)||void 0===t||t.send(w))}onMessage(e){if(e===w){var t,i;(null===(t=this.control)||void 0===t?void 0:t.readyState)==="open"&&(null===(i=this.control)||void 0===i||i.send(y));return}if(e!==y)return;let n=performance.now()-this.lastPingSentAt;this.window.unshift(n),this.window.length>50&&this.window.pop(),this.last=n,this.max=Math.max(...this.window),this.min=Math.min(...this.window),this.average=this.window.reduce((e,t)=>e+t,0)/this.window.length,this.window.length>1&&(this.jitter=this.window.slice(1).map((e,t)=>Math.abs(e-this.window[t])).reduce((e,t)=>e+t,0)/(this.window.length-1)),setTimeout(()=>this.ping(),500-n)}constructor(e,t){n(this,"peer",void 0),n(this,"control",void 0),n(this,"window",void 0),n(this,"lastPingSentAt",void 0),n(this,"last",void 0),n(this,"average",void 0),n(this,"jitter",void 0),n(this,"max",void 0),n(this,"min",void 0),this.peer=e,this.control=t,this.window=[],this.lastPingSentAt=0,this.last=0,this.average=0,this.jitter=0,this.max=0,this.min=0,void 0!==t&&(this.ping(),t.addEventListener("message",e=>this.onMessage(e.data)))}}class b{close(e){!this.closing&&(this.closing=!0,this.signaling.send({type:"disconnected",id:this.id,reason:null!=e?e:"normal closure"}),Object.values(this.channels).forEach(e=>e.close()),this.conn.close(),this.network._removePeer(this),null!=this.checkStateInterval&&clearInterval(this.checkStateInterval),null!=this.reportLatencyEventTimeout&&clearTimeout(this.reportLatencyEventTimeout),this.opened&&(this.network.emit("disconnected",this),this.signaling.event("rtc","disconnected",{target:this.id,reason:null!=e?e:"",reconnecting:this.reconnecting?"true":"false"})))}checkState(){var e;let t=performance.now(),i=null!==(e=this.conn.connectionState)&&void 0!==e?e:this.conn.iceConnectionState;if(!this.closing){if(!this.opened){"failed"===i&&this.close("connecting failed");return}if(Object.values(this.channels).some(e=>"open"!==e.readyState)&&this.close("data channel closed"),this.reconnecting||"disconnected"!==i&&"failed"!==i?this.reconnecting&&"connected"===i?(this.reconnecting=!1,this.network.emit("reconnected",this),this.signaling.event("rtc","attempt-reconnected",{target:this.id})):this.reconnecting&&t>this.abortReconnectionAt&&this.close("reconnection timed out"):(this.reconnecting=!0,this.abortReconnectionAt=t+8e3,this.network.emit("reconnecting",this),this.signaling.event("rtc","attempt-reconnect",{target:this.id})),!this.reconnecting&&"control"in this.channels){let e=this.lastMessageReceivedAt;0!==e&&t-e>1e3&&t>this.allowNextManualRestartIceAt&&(this.allowNextManualRestartIceAt=t+1e4,this.conn.restartIce())}}}onError(e){this.network.emit("rtcerror",e),0===this.network.listenerCount("rtcerror")&&console.error("rtcerror not handled:",e),this.checkState(),this.signaling.event("rtc","error",{target:this.id,error:JSON.stringify(e)})}async _onSignalingMessage(e){switch(e.type){case"candidate":if(null!=e.candidate)try{await this.conn.addIceCandidate(e.candidate)}catch(e){if(!this.ignoreOffer)throw e}break;case"description":{let{description:i}=e,n=!this.makingOffer&&("stable"===this.conn.signalingState||this.isSettingRemoteAnswerPending),s="offer"===i.type&&!n;if(this.ignoreOffer=!this.polite&&s,this.ignoreOffer)return;if(this.isSettingRemoteAnswerPending="answer"===i.type,await this.conn.setRemoteDescription(i),this.isSettingRemoteAnswerPending=!1,"offer"===i.type){await this.conn.setLocalDescription();let e=this.conn.localDescription;if(null!=e){var t;await (null===(t=this.testSessionWrapper)||void 0===t?void 0:t.call(this,e,this.config,this.network.id,this.id)),this.signaling.send({type:"description",source:this.network.id,recipient:this.id,description:e})}}}}}send(e,t){if(!(e in this.channels))throw Error("unknown channel "+e);let i=this.channels[e];"open"===i.readyState&&i.send(t)}toString(){return`[Peer: ${this.id}]`}constructor(e,t,i,s,r){n(this,"network",void 0),n(this,"signaling",void 0),n(this,"id",void 0),n(this,"config",void 0),n(this,"polite",void 0),n(this,"conn",void 0),n(this,"makingOffer",void 0),n(this,"ignoreOffer",void 0),n(this,"isSettingRemoteAnswerPending",void 0),n(this,"opened",void 0),n(this,"closing",void 0),n(this,"reconnecting",void 0),n(this,"abortReconnectionAt",void 0),n(this,"allowNextManualRestartIceAt",void 0),n(this,"latency",void 0),n(this,"lastMessageReceivedAt",void 0),n(this,"politenessTimeout",void 0),n(this,"reportLatencyEventTimeout",void 0),n(this,"checkStateInterval",void 0),n(this,"channels",void 0),n(this,"testSessionWrapper",void 0),this.network=e,this.signaling=t,this.id=i,this.config=s,this.polite=r,this.makingOffer=!1,this.ignoreOffer=!1,this.isSettingRemoteAnswerPending=!1,this.opened=!1,this.closing=!1,this.reconnecting=!1,this.abortReconnectionAt=0,this.allowNextManualRestartIceAt=0,this.latency=new m(this),this.lastMessageReceivedAt=0,this.channels={},this.network.log("creating peer"),this.testSessionWrapper=void 0,this.conn=new RTCPeerConnection(s),void 0===s.testproxyURL?this.conn.addEventListener("icecandidate",e=>{let i=e.candidate;null!==i&&t.send({type:"candidate",source:this.network.id,recipient:this.id,candidate:i})}):this.testSessionWrapper=k,this.conn.addEventListener("negotiationneeded",()=>{this.politenessTimeout=setTimeout(()=>{(async function(){try{if(t.closing)return;t.makingOffer=!0,await t.conn.setLocalDescription();let i=t.conn.localDescription;if(null!=i){var e,t;await (null===(e=t.testSessionWrapper)||void 0===e?void 0:e.call(t,i,t.config,t.network.id,t.id)),t.signaling.send({type:"description",source:t.network.id,recipient:t.id,description:i})}}catch(i){let e=new f("unknown-error",i);t.network._onSignalingError(e)}finally{t.makingOffer=!1}})().catch(e=>{})},this.polite?100:0)}),this.checkStateInterval=setInterval(()=>{this.checkState()},500),this.conn.addEventListener("signalingstatechange",()=>this.checkState()),this.conn.addEventListener("connectionstatechange",()=>this.checkState()),this.conn.addEventListener("iceconnectionstatechange",()=>this.checkState()),this.network.emit("connecting",this);let c=0;for(let e in this.network.dataChannels){let t=this.conn.createDataChannel(e,function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);i.push.apply(i,n)}return i})(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}),e}(o({},this.network.dataChannels[e]),{id:c++,negotiated:!0}));t.binaryType="arraybuffer",t.addEventListener("error",e=>this.onError(e)),t.addEventListener("closing",()=>this.checkState()),t.addEventListener("close",()=>this.checkState()),t.addEventListener("open",()=>{this.opened||Object.values(this.channels).some(e=>"open"!==e.readyState)||("control"in this.channels&&(this.latency=new m(this,this.channels.control)),void 0!==this.politenessTimeout&&clearTimeout(this.politenessTimeout),this.signaling.send({type:"connected",id:this.id}),this.opened=!0,this.network.emit("connected",this),this.signaling.event("rtc","connected",{target:this.id}),this.reportLatencyEventTimeout=setTimeout(()=>{this.signaling.event("rtc","avg-latency-at-10s",{target:this.id,latency:`${this.latency.average}`})},1e4))}),t.addEventListener("message",t=>{this.lastMessageReceivedAt=performance.now(),"control"!==e&&this.network.emit("message",this,e,t.data)}),this.channels[e]=t}}}async function k(e,t,i,n){if(void 0===t.testproxyURL)return;let s=e.sdp.split("\r\n");s=s.filter(e=>!e.startsWith("a=candidate")||e.includes("127.0.0.1")&&e.includes("udp"));for(let e=0;e<s.length;e++){let o=s[e];if(o.startsWith("a=candidate")&&o.includes("127.0.0.1")){var r;let c=null===(r=o.split("127.0.0.1 ").pop())||void 0===r?void 0:r.split(" ")[0];if(null!=c){let r=await fetch(`${t.testproxyURL}/create?id=${i+n}&port=${c}`),a=await r.text();s[e]=o.replaceAll(` ${c} `,` ${a} `)}}}e.sdp=s.join("\r\n")}class S extends c.EventEmitter{async list(e){if(this._closing||void 0===this.signaling.receivedID)return[];let t=null!=e?JSON.stringify(e):void 0,i=await this.signaling.request({type:"list",filter:t});return"lobbies"===i.type?i.lobbies:[]}async create(e){if(this._closing||void 0===this.signaling.receivedID)return"";let t=await this.signaling.request(o({type:"create"},e));return"joined"===t.type?t.lobbyInfo.code:""}async join(e,t){if(this._closing||void 0===this.signaling.receivedID)return;let i=await this.signaling.request({type:"join",lobby:e,password:t});if("joined"===i.type)return i.lobbyInfo}async setLobbySettings(e){return this._closing||void 0===this.signaling.receivedID?Error("network is closing or not connected"):(await this.signaling.request(o({type:"lobbyUpdate"},e)),!0)}close(e){this._closing||void 0===this.signaling.receivedID||(this._closing=!0,this.emit("close",e),""!==this.id&&this.signaling.send({type:"close",id:this.id,reason:null!=e?e:"normal closure"}),this.peers.forEach(t=>t.close(e)),this.signaling.close(),"undefined"!=typeof window&&window.removeEventListener("unload",this.unloadListener))}send(e,t,i){var n;if(!(e in this.dataChannels))throw Error("unknown channel "+e);this.peers.has(t)&&(null===(n=this.peers.get(t))||void 0===n||n.send(e,i))}broadcast(e,t){if(!(e in this.dataChannels))throw Error("unknown channel "+e);this.peers.forEach(i=>i.send(e,t))}async _addPeer(e,t){var i;let n=await this.credentials.fillCredentials(this.rtcConfig);n.iceServers=null===(i=n.iceServers)||void 0===i?void 0:i.filter(e=>!(e.urls.includes("turn:")&&void 0===e.username));let s=new b(this,this.signaling,e,n,t);this.peers.set(e,s)}_removePeer(e){return this.peers.delete(e.id)}_prefetchTURNCredentials(){this.credentials.fillCredentials(this.rtcConfig).catch(()=>{})}_onSignalingError(e){this.emit("signalingerror",e),0===this.listenerCount("signalingerror")&&console.error("signallingerror not handled:",e),this.signaling.event("signaling","error",{error:JSON.stringify(e)})}_forceReconnectSignaling(){this.signaling.close()}get id(){var e;return null!==(e=this.signaling.receivedID)&&void 0!==e?e:""}get closing(){return this._closing}get size(){return this.peers.size}get currentLobby(){return this.signaling.currentLobby}get currentLobbyInfo(){return this.signaling.currentLobbyInfo}get currentLeader(){return this.signaling.currentLeader}constructor(e,t=L,i=E){super(),n(this,"gameID",void 0),n(this,"rtcConfig",void 0),n(this,"_closing",void 0),n(this,"peers",void 0),n(this,"signaling",void 0),n(this,"credentials",void 0),n(this,"dataChannels",void 0),n(this,"log",void 0),n(this,"unloadListener",void 0),this.gameID=e,this.rtcConfig=t,this._closing=!1,this.dataChannels=O,this.log=(...e)=>{},this.peers=new Map,this.signaling=new p(this,this.peers,i),this.credentials=new r(this.signaling),this.unloadListener=()=>this.close(),"undefined"!=typeof window&&window.addEventListener("unload",this.unloadListener)}}let E="wss://netlib.poki.io/v0/signaling",L={iceServers:[{urls:["stun:stun.l.google.com:19302"]},{urls:s}]},O={reliable:{ordered:!0},unreliable:{ordered:!0,maxRetransmits:0},control:{ordered:!1}};("undefined"!=typeof Module?Module:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}).netlib=i}();
//# sourceMappingURL=netlib_46ed163.js.map
